# Additional Security Rules for Nginx
# Include this file in your main nginx configuration

# Block SQL injection attempts
location ~ (union.*select|insert.*into|drop.*table|update.*set|delete.*from) {
    deny all;
    return 444;
}

# Block XSS attempts
location ~ (<script|<iframe|javascript:|onerror=|onload=) {
    deny all;
    return 444;
}

# Block common vulnerability scanners
map $http_user_agent $is_scanner {
    default 0;
    ~*acunetix 1;
    ~*nikto 1;
    ~*sqlmap 1;
    ~*nessus 1;
    ~*openvas 1;
    ~*vega 1;
    ~*w3af 1;
    ~*dirbuster 1;
    ~*metasploit 1;
    ~*nmap 1;
    ~*masscan 1;
}

# Block requests with no user agent
map $http_user_agent $no_ua {
    default 0;
    "" 1;
}

# Block suspicious referrers
map $http_referer $bad_referer {
    default 0;
    ~*(<script|javascript:|data:text) 1;
}

